<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Page</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <link href="/css/style.css" rel="stylesheet">
</head>

<body>

    <div class="wrapper">
        <div class="container">
            <h1 class="welcome-header">Welcome</h1>

            <div class="form">
                <label for="usernameInput">Username:<label></label>
                    <input id="usernameInput" class="form-input" type="text" placeholder="Username">

                    <label for="passwordInput">Password:<label></label>
                        <input id="passwordInput" class="form-input" type="password" placeholder="Password">
                        <button id="login-button" onclick="login()">Login</button>
            </div>
        </div>

    </div>

</body>
<script>

    let usernameInput;
    let passwordInput;


    async function login() {
        usernameInput = document.getElementById("usernameInput").value;
        passwordInput = document.getElementById("passwordInput").value;

        console.log(usernameInput);
        console.log(passwordInput);

        const url = `http://localhost:7000/employees/${usernameInput}`;

        const httpResponse = await fetch(url);

        const employee = await httpResponse.json();

        console.log(employee);

        JSON.stringify(employee);

        console.log(Object.keys(employee).length);

        if (Object.keys(employee).length != 0 && employee.password === passwordInput) {
            console.log("Success!")

            // enter found employee to local storage to access on different HTML page
            localStorage.setItem("eID", employee.eID);
            localStorage.setItem("firstName", employee.firstName);
            localStorage.setItem("lastName", employee.lastName);
            localStorage.setItem("jobPosition", employee.jobPosition);
            localStorage.setItem("username", employee.username);
            localStorage.setItem("password", employee.password);
            localStorage.setItem("benco", employee.benco);
            localStorage.setItem("email", employee.email);
            localStorage.setItem("dID", employee.dID);

            localStorage.setItem("dID", employee.department['dID']);
            localStorage.setItem("deptName", employee.department['deptName']);

            window.location.href = "portal.html";

        } else {
            console.log("Fail")

            // not displaying
            let p = document.createElement("p");                 // Create a <p> node
            p.textContent = "You entered the wrong info!"       // Create a text node
            document.body.appendChild(p);
        }

    }


</script>

</html>